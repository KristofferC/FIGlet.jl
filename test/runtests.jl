using FIGlet
using Test

EXCEPTIONS = [
              "1943____.flf",
              "3d.flf",
              "4x4_offr.flf",
              "5x8.flf",
              "64f1____.flf",
              "ANSI Regular.flf",
              "ANSI Shadow.flf",
              "Bloody.flf",
              "Calvin S.flf",
              "DOS Rebel.flf",
              "Delta Corps Priest 1.flf",
              "Diet Cola.flf",
              "Electronic.flf",
              "Elite.flf",
              "JS Cursive.flf",
              "Stronger Than All.flf",
              "THIS.flf",
              "The Edge.flf",
              "a_zooloo.flf",
              "advenger.flf",
              "aquaplan.flf",
              "asc_____.flf",
              "ascii___.flf",
              "assalt_m.flf",
              "asslt__m.flf",
              "atc_____.flf",
              "atc_gran.flf",
              "b_m__200.flf",
              "banner.flf",
              "battle_s.flf",
              "battlesh.flf",
              "baz__bil.flf",
              "bear.flf",
              "beer_pub.flf",
              "big.flf",
              "brite.flf",
              "briteb.flf",
              "britebi.flf",
              "britei.flf",
              "bubble__.flf",
              "bubble_b.flf",
              "c1______.flf",
              "c2______.flf",
              "c_ascii_.flf",
              "c_consen.flf",
              "caus_in_.flf",
              "char1___.flf",
              "char2___.flf",
              "char3___.flf",
              "char4___.flf",
              "charact1.flf",
              "charact2.flf",
              "charact3.flf",
              "charact4.flf",
              "charact5.flf",
              "charact6.flf",
              "characte.flf",
              "charset_.flf",
              "cns.flf",
              "coil_cop.flf",
              "cola.flf",
              "com_sen_.flf",
              "convoy__.flf",
              "cour.flf",
              "courb.flf",
              "courbi.flf",
              "couri.flf",
              "d_dragon.flf",
              "dcs_bfmo.flf",
              "deep_str.flf",
              "demo_1__.flf",
              "demo_2__.flf",
              "demo_m__.flf",
              "devilish.flf",
              "dietcola.flf",
              "double.flf",
              "druid___.flf",
              "e__fist_.flf",
              "ebbs_1__.flf",
              "ebbs_2__.flf",
              "eca_____.flf",
              "etcrvs__.flf",
              "f15_____.flf",
              "faces_of.flf",
              "fair_mea.flf",
              "fairligh.flf",
              "fantasy_.flf",
              "fbr12___.flf",
              "fbr1____.flf",
              "fbr2____.flf",
              "fbr_stri.flf",
              "fbr_tilt.flf",
              "finalass.flf",
              "fireing_.flf",
              "flipped.flf",
              "flyn_sh.flf",
              "fp1_____.flf",
              "fp2_____.flf",
              "funky_dr.flf",
              "future_1.flf",
              "future_2.flf",
              "future_3.flf",
              "future_4.flf",
              "future_5.flf",
              "future_6.flf",
              "future_7.flf",
              "future_8.flf",
              "gauntlet.flf",
              "ghost_bo.flf",
              "gothic__.flf",
              "grand_pr.flf",
              "green_be.flf",
              "hades___.flf",
              "heavy_me.flf",
              "helv.flf",
              "helvb.flf",
              "helvbi.flf",
              "helvi.flf",
              "heroboti.flf",
              "high_noo.flf",
              "hills___.flf",
              "home_pak.flf",
              "house_of.flf",
              "hypa_bal.flf",
              "hyper___.flf",
              "inc_raw_.flf",
              "italics_.flf",
              "ivrit.flf",
              "jiskan16.flf",
              "joust___.flf",
              "kgames_i.flf",
              "kik_star.flf",
              "knob.flf",
              "krak_out.flf",
              "lazy_jon.flf",
              "letter_w.flf",
              "letterw3.flf",
              "lexible_.flf",
              "mad_nurs.flf",
              "magic_ma.flf",
              "master_o.flf",
              "maxiwi.flf",
              "mayhem_d.flf",
              "mcg_____.flf",
              "mig_ally.flf",
              "miniwi.flf",
              "modern__.flf",
              "new_asci.flf",
              "nfi1____.flf",
              "notie_ca.flf",
              "npn_____.flf",
              "nvscript.flf",
              "odel_lak.flf",
              "ok_beer_.flf",
              "outrun__.flf",
              "p_s_h_m_.flf",
              "p_skateb.flf",
              "pacos_pe.flf",
              "panther_.flf",
              "pawn_ins.flf",
              "phonix__.flf",
              "platoon2.flf",
              "platoon_.flf",
              "pod_____.flf",
              "r2-d2___.flf",
              "rad_____.flf",
              "rad_phan.flf",
              "radical_.flf",
              "rainbow_.flf",
              "rally_s2.flf",
              "rally_sp.flf",
              "rampage_.flf",
              "rastan__.flf",
              "raw_recu.flf",
              "rci_____.flf",
              "ripper!_.flf",
              "road_rai.flf",
              "rockbox_.flf",
              "rok_____.flf",
              "roman___.flf",
              "rotated.flf",
              "sans.flf",
              "sansb.flf",
              "sansbi.flf",
              "sansi.flf",
              "sbook.flf",
              "sbookb.flf",
              "sbookbi.flf",
              "sbooki.flf",
              "script__.flf",
              "skate_ro.flf",
              "skateord.flf",
              "skateroc.flf",
              "sketch_s.flf",
              "sm______.flf",
              "space_op.flf",
              "spc_demo.flf",
              "star_war.flf",
              "stealth_.flf",
              "stencil1.flf",
              "stencil2.flf",
              "street_s.flf",
              "subteran.flf",
              "super_te.flf",
              "t__of_ap.flf",
              "tav1____.flf",
              "taxi____.flf",
              "tec1____.flf",
              "tec_7000.flf",
              "tecrvs__.flf",
              "ti_pan__.flf",
              "times.flf",
              "timesofl.flf",
              "tomahawk.flf",
              "top_duck.flf",
              "trashman.flf",
              "triad_st.flf",
              "ts1_____.flf",
              "tsm_____.flf",
              "tsn_base.flf",
              "twin_cob.flf",
              "type_set.flf",
              "ucf_fan_.flf",
              "ugalympi.flf",
              "unarmed_.flf",
              "usa_____.flf",
              "usa_pq__.flf",
              "utopia.flf",
              "utopiab.flf",
              "utopiabi.flf",
              "utopiai.flf",
              "vortron_.flf",
              "war_of_w.flf",
              "xbrite.flf",
              "xbriteb.flf",
              "xbritebi.flf",
              "xbritei.flf",
              "xcour.flf",
              "xcourb.flf",
              "xcourbi.flf",
              "xcouri.flf",
              "xhelv.flf",
              "xhelvb.flf",
              "xhelvbi.flf",
              "xhelvi.flf",
              "xsans.flf",
              "xsansb.flf",
              "xsansbi.flf",
              "xsansi.flf",
              "xsbook.flf",
              "xsbookb.flf",
              "xsbookbi.flf",
              "xsbooki.flf",
              "xtimes.flf",
              "xtty.flf",
              "xttyb.flf",
              "yie-ar__.flf",
              "yie_ar_k.flf",
              "z-pilot_.flf",
              "zig_zag_.flf",
              "zone7___.flf",
           ]

@testset "FIGlet.jl" begin
    iob = IOBuffer(b"flf2a", read=true);
    @test FIGlet.readmagic(iob) == UInt8['f', 'l', 'f', '2', 'a']

    @test FIGlet.FIGletHeader('$', 6, 5, 16, 15, 11) == FIGlet.FIGletHeader('$', 6, 5, 16, 15, 11, 0, 2, 0)

    for (root, dirs, files) in walkdir(FIGlet.FONTS)
        for file in files
            if endswith(file, ".flf") && !any(occursin.(file, EXCEPTIONS))
                open(joinpath(root, file)) do f
                    @test FIGlet.readfont(f) isa FIGlet.FIGletFont
                end
            end
        end
    end

end
